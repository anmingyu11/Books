## 你的第一个C语言程序

我们有两种方式从计算机获得信息：一是看屏幕上的文字、图片、视频等，二是听从喇叭发出来的声音。让喇叭发出声音目前还比较麻烦，我们先来看看如何在屏幕上显示一些文字吧。

在屏幕上显示文字非常简单，只需要一个语句，例如，下面的代码会让屏幕显示出“HelloWorld”：
```
puts("C语言中文网");
```
这里有一个生疏的词汇`puts`，用来让计算机在屏幕上显示文字。
更加专业的称呼：

- "在屏幕上显示文字"叫做**输出（Output**；
- 每个文字都是一个**字符（Character）**；
- 多个字符组合起来，就是一个字符序列，叫做**字符串（String）**。

`puts`是 output string 的缩写，意思是”输出字符串“。

在C语言中，字符串需要用双引号" "包围起来，HelloWorld什么也不是，计算机不认识它，"HelloWorld"才是字符串。

puts 在输出字符串的时候，需要将字符串放在( )内。

在汉语和英语中，分别使用`。`和`.`表示一句话的结束，而在C语言中，使用;表示一个语句的结束。puts("HelloWorld")表达了完整的意思，是一个完整的语句，需要在最后加上;，表示当前语句结束了。

总结起来，上面的语句可以分为三个部分：
- puts( )命令计算机输出字符串；
- "HelloWorld"是要输出的内容；
- ;表示语句结束。

### C语言程序的整体框架

puts 可以在显示器上输出内容，但是仅有 puts 是不够的，程序不能运行，还需要添加其他代码，构成一个完整的框架。完整的程序如下：

```
#include <stdio.h>
int main()
{
    puts("HelloWorld");
    return 0;
}
```

第 1~3 行、第 5~6 行是固定的，所有C语言源代码都必须有这几行。你暂时不需要理解它们是什么意思，反正有这个就是了，以后会慢慢讲解。

但是请记住，今后我们写的所有类似 puts 这样的语句，都必须放在{ }之间才有效。

### C语言输入法的选择

计算机起源于美国，C语言、C++、Java、JavaScript 等很多流行的编程语言都是美国人发明的，所以在编写代码的时候必须使用英文半角输入法，尤其是标点符号，初学者一定要引起注意。

例如，上节我们使用 puts 语句在显示器上输出内容：
```
puts("C语言中文网");
```
这里的括号、双引号、分号都必须是英文符号，而且是半角的。
一些相似的中英文标点符号：

- 中文分号`；`和英文分号`;`；
- 中文逗号`，`和英文逗号`,`；
- 中文冒号`：`和英文冒号`:`；
- 中文括号`（）`和英文括号`()`；
- 中文问号`？`和英文问号`?`；
- 中文单引号`’‘`和英文单引号`' '`；
- 中文双引号`“ ”`和英文双引号`" "`。

### 全角和半角输入法的区别

全角和半角的区别主要在于除汉字以外的其它字符，比如标点符号、英文字母、阿拉伯数字等，全角字符和半角字符所占用的位置的大小不同。

在计算机屏幕上，一个汉字要占两个英文字符的位置，人们把一个英文字符所占的位置称为“半角”，相对地把一个汉字所占的位置称为“全角”。

标点符号、英文字母、阿拉伯数字等这些字符不同于汉字，在半角状态它们被作为英文字符处理，而在全角状态作为中文字符处理，请看下面的例子。

半角输入：
```
C语言中文网！Hello C,I like!
```

全角输入：
```
Ｃ语言中文网！Ｈｅｌｌｏ　Ｃ，Ｉ　ｌｉｋｅ！
```

**另外最重要的一点是：“相同”字符在全角和半角状态下对应的编码值（例如 Unicode 编码、GBK 编码等）不一样，所以它们是不同的字符**

### C语言编译器，神奇的魔法师

我们平时所说的程序，是指双击后就可以直接运行的程序，这样的程序被称为**可执行程序**（Executable Program）。在 Windows 下，可执行程序的后缀有 .exe 和 .com（其中 .exe 比较常见）；在类 UNIX 系统（Linux、Mac OS 等）下，**可执行程序没有特定的后缀，系统根据文件的头部信息来判断是否是可执行程序。**

可执行程序的内部是一系列计算机指令和数据的集合，它们都是二进制形式的，CPU 可以直接识别，毫无障碍；但是对于程序员，它们非常晦涩，难以记忆和使用。

例如，在屏幕上输出“HelloWorld”，C语言的写法为：
```
puts("HelloWorld")
```
二进制的写法为：
![](./Chap-02-0201-01-Instruction.jpg)

你感受一下，直接使用二进制是不是想撞墙，是不是受到一吨重的伤害？

>在计算机发展的初期，程序员就是使用这样的二进制指令来编写程序的，那个拓荒的年代还没有编程语言。

直接使用二进制指令编程对程序员来说简直是噩梦，尤其是当程序比较大的时候，不但编写麻烦，需要频繁查询指令手册，而且除错会异常苦恼，要直接面对一堆二进制数据，让人眼花缭乱。另外，用二进制指令编程步骤繁琐，要考虑各种边界情况和底层问题，开发效率十分低下。

这就倒逼程序员开发出了编程语言，提高自己的生产力，例如汇编、C语言、C++、Java、Python、Go语言等，都是在逐步提高开发效率。至此，编程终于不再是只有极客能做的事情了，不了解计算机的读者经过一定的训练也可以编写出有模有样的程序。

### 什么是编译器

C语言代码由固定的词汇按照固定的格式组织起来，简单直观，程序员容易识别和理解，但是对于CPU，C语言代码就是天书，根本不认识，CPU只认识几百个二进制形式的指令。这就需要一个工具，将C语言代码转换成CPU能够识别的二进制指令，也就是将代码加工成 .exe 程序；这个工具是一个特殊的软件，叫做编译器（Compiler）。

编译器能够识别代码中的词汇、句子以及各种特定的格式，并将他们转换成计算机能够识别的二进制形式，这个过程称为编译（Compile）。

编译也可以理解为“翻译”，类似于将中文翻译成英文、将英文翻译成象形文字，它是一个复杂的过程，**大致包括词法分析、语法分析、语义分析、性能优化、生成可执行文件五个步骤，期间涉及到复杂的算法和硬件架构。** 对于学计算机或者软件的大学生，“编译原理”是一门专业课程，有兴趣的读者请自行阅读《编译原理》一书，这里我们不再展开讲解。

>注意：不了解编译原理并不影响我们学习C语言，我也不建议初学者去钻研编译原理，贪多嚼不烂，不要把自己绕进去。

C语言的编译器有很多种，不同的平台下有不同的编译器，例如：

- Windows 下常用的是微软开发的**cl.exe**，它被集成在 Visual Studio 或 Visual C++ 中，一般不单独使用；
- Linux 下常用的是 GUN 组织开发的 **GCC**，很多 Linux 发行版都自带 GCC；
- Mac 下常用的是 **LLVM/Clang**，它被集成在 Xcode 中（Xcode 以前集成的是 GCC，后来由于 GCC 的不配合才改为 LLVM/Clang，LLVM/Clang 的性能比 GCC 更加强大）。

你的代码语法正确与否，编译器说了才算，我们学习C语言，从某种意义上说就是学习如何使用编译器，让编译器生成可执行程序（例如 Windows 下的 .exe 程序）。

编译器可以 100% 保证你的代码从语法上讲是正确的，因为哪怕有一点小小的错误，编译也不能通过，编译器会告诉你哪里错了，便于你的更改。

### 什么是集成开发环境

实际开发中，除了编译器是必须的工具，我们往往还需要很多其他辅助软件，例如：

- 编辑器：用来编写代码，并且给代码着色，以方便阅读；
- 代码提示器：输入部分代码，即可提示全部代码，加速代码的编写过程；
- 调试器：观察程序的每一个运行步骤，发现程序的逻辑错误；
- 项目管理工具：对程序涉及到的所有资源进行管理，包括源文件、图片、视频、第三方库等；
- 漂亮的界面：各种按钮、面板、菜单、窗口等控件整齐排布，操作更方便。

**集成开发环境** 就是一系列开发工具的组合套装。这就好比台式机，一个台式机的核心部件是主机，有了主机就能独立工作了，但是我们在购买台式机时，往往还要附带上显示器、键盘、鼠标、U盘、摄像头等外围设备，因为只有主机太不方便了，必须有外设才能玩的爽。

## 使用编译器之前请了解几个概念
上节我们介绍了编译器和 IDE 的概念，大家肯定希望赶紧实践一下，用 IDE 真正地运行一段C语言代码来看看效果，这样能够更快地获得成就感。

但是，使用 IDE 的过程中会涉及到一些与编程有关的概念，这些概念如果不提前了解，即使能够运行出程序来，也是雾里看花，知其然不知其所以然。本节的目标就是让大家对这些概念有一个简单的了解。

### 1) 源文件（Source File）

在开发软件的过程中，我们需要将编写好的代码（Code）保存到一个文件中，这样代码才不会丢失，才能够被编译器找到，才能最终变成可执行文件。这种用来保存代码的文件就叫做源文件（Source File）。

每种编程语言的源文件都有特定的后缀，以方便被编译器识别，被程序员理解。源文件后缀大都根据编程语言本身的名字来命名，例如：

- C语言源文件的后缀是`.c`；
- C++语言（C Plus Plus）源文件的后缀是`.cpp`；
- Java 源文件的后缀是`.java`；
- Python 源文件的后缀是`.py`；
- JavaScript 源文件后置是`.js`。

**源文件其实就是纯文本文件，它的内部并没有特殊格式**，能证明这一结论的典型例子是：在 Windows 下用记事本程序新建一个文本文档，并命名为demo.txt，输入一段C语言代码并保存，然后将该文件强制重命名为demo.c（后缀从.txt变成了.c），发现编译器依然能够正确识别其中的C语言代码，并顺利生成可执行文件。

源文件的后缀仅仅是为了表明该文件中保存的是某种语言的代码（例如.c文件中保存的是C语言代码），这样程序员更加容易区分，编译器也更加容易识别，它并不会导致该文件的内部格式发生改变。

C++ 是站在C语言的肩膀上发展期来的，是在C语言的基础上进行的扩展，C++ 包含了C语言的全部内容），将C语言代码放在.cpp文件中不会有错，很多初学者都是这么做的，很多大学老师也是这么教的。但是，我还是强烈建议将C语言代码放在.c文件中，这样能够更加严格地遵循C语言的语法，也能够更加清晰地了解C语言和C++的区别。

### 2) 工程/项目（Project）

一个真正的程序（也可以说软件）往往包含多项功能，每一项功能都需要几十行甚至几千行、几万行的代码来实现，如果我们将这些代码都放到一个源文件中，那将会让人崩溃，不但源文件打开速度极慢，代码的编写和维护也将变得非常困难。

在实际开发中，程序员都是将这些代码分门别类地放到多个源文件中。除了这些成千上万行的代码，一个程序往往还要包含图片、视频、音频、控件、库（也可以说框架）等其它资源，它们也都是一个一个地文件。

为了有效地管理这些种类繁杂、数目众多的文件，我们有理由把它们都放到一个目录（文件夹）下，并且这个目录下只存放与当前程序有关的资源。实际上 IDE 也是这么做的，它会为每一个程序都创建一个专门的目录，将用到的所有文件都集中到这个目录下，并对它们进行便捷的管理，比如重命名、删除文件、编辑文件等。

**这个为当前程序配备的专用文件夹，在 IDE 中也有一个专门的称呼，叫做“Project”，翻译过来就是“工程”或者“项目”。在 VC 6.0 下，这叫做一个“工程”，而在 VS 下，这又叫做一个“项目”，它们只是单词“Project”的不同翻译而已，实际上是一个概念。**

### 3) 工程类型/项目类型
“程序”是一个比较宽泛的称呼，它可以细分为很多种类，例如：

- 有的程序不带界面，完全是“黑屏”的，只能输入一些字符或者命令，称为控制台程序（Console Application），例如 Windows 下的 cmd.exe，Linux 或 Mac OS 下的终端（Terminal）。
- 有的程序带界面，看起来很漂亮，能够使用鼠标点击，称为GUI程序（Graphical User Interface Program），例如 QQ、迅雷、Chrome 等。
- 有的程序不单独出现，而是作为其它程序的一个组成部分，普通用户很难接触到它们，例如静态库、动态库等。

**不同的程序对应不同的工程类型（项目类型），使用 IDE 时必须选择正确的工程类型才能创建出我们想要的程序。换句话说，IDE 包含了多种工程类型，不同的工程类型会创建出不同的程序。**

不同的工程类型本质上是对 IDE 中各个参数的不同设置；我们也可以创建一个空白的工程类型，然后自己去设置各种参数（不过一般不这样做）。

控制台程序对应的工程类型为“Win32控制台程序（Win32 Console Application）”，GUI程序对应的工程类型为“Win32程序（Win32 Application）”。

控制台程序是 DOS 时代的产物了，它没有复杂的功能，没有漂亮的界面，只能看到一些文字，虽然枯燥无趣，也不实用，但是它非常简单，不受界面的干扰，所以适合入门，我强烈建议初学者从控制台程序学起。等大家对编程掌握的比较熟练了，能编写上百行的代码了，再慢慢过渡到GUI程序。

### 4) 链接（Link）

**上节我们讲到，源代码经过编译（Compile）后就变成了可执行文件，其实这种说法有点笼统，甚至从严格意义上来讲是错误的。源代码要经过编译（Compile）和链接（Link）两个过程才能变成可执行文件。**

编译器一次只能编译一个源文件，如果当前程序包含了多个源文件，那么就需要编译多次。编译器每次编译的结果是产生一个中间文件（可以认为是一种临时文件），而不是最终的可执行文件。中间文件已经非常接近可执行文件了，它们都是二进制格式，内部结构也非常相似。

**将当前程序的所有中间文件以及系统库（暂时可以理解为系统中的一些组件）组合在一起，才能形成最终的可执行文件，这个组合的过程就叫做链接（Link）。完成链接功能的软件叫做链接器（Linker）。**

如果程序只包含了一个源文件，是不是就不需要链接了呢？不是的！

**经过编译后程序虽然只有一个中间文件，不再需要和其它的中间文件组合了，但是这个唯一的中间文件还需要和系统库组合，这个过程也是链接。也就是说，不管有多少个源文件，都必须经过编译和链接两个过程才能生成可执行文件。**
